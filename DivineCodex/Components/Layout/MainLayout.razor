@inherits LayoutComponentBase
@using MudBlazor

<link href="_content/MudBlazor/MudBlazor.min.css" rel="stylesheet" />

<MudThemeProvider Theme="_theme" />
<MudDialogProvider />
<MudSnackbarProvider />
<MudPopoverProvider />

<MudLayout>
    <MudAppBar Elevation="4" Color="Color.Dark" Class="app-bar animated-gradient">
        <MudIconButton Icon="@Icons.Material.Filled.Menu"
                       Color="Color.Inherit"
                       Edge="Edge.Start"
                       OnClick="@ToggleDrawer"
                       Class="drawer-toggle mr-2 hover-scale" />
        <MudText Typo="Typo.h5" Class="app-title pulse-animation">
            <MudIcon Icon="@Icons.Material.Filled.Code" Class="mr-2 code-icon" />
            Code Bounty Hunter
        </MudText>
        <MudSpacer />

        <MudTooltip Text="Toggle Dark/Light Mode">
            <MudIconButton Icon="@(_isDarkMode ? Icons.Material.Filled.LightMode : Icons.Material.Filled.DarkMode)"
                           Color="Color.Inherit"
                           OnClick="ToggleTheme"
                           Class="theme-toggle hover-rotate" />
        </MudTooltip>

        <MudMenu Icon="@Icons.Material.Filled.AccountCircle"
                 Color="Color.Inherit"
                 Label="Profile"
                 Class="profile-menu hover-scale">
            <MudMenuItem>Profile</MudMenuItem>
            <MudMenuItem>Settings</MudMenuItem>
            <MudDivider />
            <MudMenuItem Color="Color.Error">Logout</MudMenuItem>
        </MudMenu>
    </MudAppBar>

    <MudDrawer @bind-Open="_drawerOpen"
               Elevation="1"
               Variant="@DrawerVariant.Mini"
               ClipMode="DrawerClipMode.Always"
               Class="animated-drawer">
        <MudNavMenu>
            <MudNavLink Href="/" Icon="@Icons.Material.Filled.Home" Class="nav-link">
                Dashboard
            </MudNavLink>
            <MudNavLink Href="/bounties" Icon="@Icons.Material.Filled.ListAlt" Class="nav-link">
                Active Bounties
            </MudNavLink>
            <MudNavLink Href="/submit" Icon="@Icons.Material.Filled.Add" Class="nav-link">
                Submit Bounty
            </MudNavLink>
            <MudNavLink Href="/leaderboard" Icon="@Icons.Material.Filled.EmojiEvents" Class="nav-link">
                Leaderboard
            </MudNavLink>
            <MudNavLink Href="/stats" Icon="@Icons.Material.Filled.Analytics" Class="nav-link">
                Statistics
            </MudNavLink>
        </MudNavMenu>
    </MudDrawer>

    <MudMainContent Class="main-content sliding-background">
        @Body
    </MudMainContent>

    <MudAppBar Elevation="1" Color="Color.Dark" Bottom="true" Class="footer glow-effect">
        <MudContainer Class="d-flex justify-center align-center">
            <MudText Typo="Typo.body2" Class="footer-text">
                © 2024 Code Bounty Hunter | All Rights Reserved
            </MudText>
        </MudContainer>
    </MudAppBar>
</MudLayout>

@code {
    private bool _drawerOpen = true;
    private bool _isDarkMode = true;
    private MudTheme _theme = new MudTheme(); // Initialize it here

    protected override void OnInitialized()
    {
        SetupTheme();
    }

    private void SetupTheme()
    {
        // Proper Palette and MudTheme setup
        _theme = new MudTheme
            {
                Palette = new Palette
                {
                    Primary = Colors.Blue.Default,
                    Secondary = Colors.Pink.Accent3,
                    Background = Colors.Grey.Lighten5,
                    Surface = Colors.Grey.Lighten3,
                    AppbarBackground = Colors.Grey.Darken4
                },
                Typography = new Typography
                {
                    Default = new Default
                    {
                        FontFamily = new[] { "Roboto", "Helvetica", "Arial", "sans-serif" }
                    }
                }
            };
    }

    private void ToggleDrawer()
    {
        _drawerOpen = !_drawerOpen;
    }

    private void ToggleTheme()
    {
        _isDarkMode = !_isDarkMode;
        SetupTheme();
    }
}

<style>
    /* Animated Gradient Background */
    .animated-gradient {
        background: linear-gradient(45deg, #1a73e8, #6a11cb, #2575fc);
        background-size: 400% 400%;
        animation: gradientBG 15s ease infinite;
    }

    /* Hover and Interaction Effects */
    .hover-scale {
        transition: transform 0.3s ease;
    }

        .hover-scale:hover {
            transform: scale(1.1);
        }

    .hover-rotate {
        transition: transform 0.4s ease;
    }

        .hover-rotate:hover {
            transform: rotate(360deg);
        }

    /* Pulse Animation for Title */
    .pulse-animation {
        animation: pulse 2s infinite;
    }

    /* Sliding Background */
    .sliding-background {
        background: linear-gradient(270deg, #1a73e8, #6a11cb, #2575fc);
        background-size: 600% 600%;
        animation: slidingBackground 20s ease infinite;
    }

    /* Glow Effect */
    .glow-effect {
        box-shadow: 0 0 20px rgba(26, 115, 232, 0.5);
    }

    /* Navigation Link Hover */
    .nav-link {
        transition: all 0.3s ease;
    }

        .nav-link:hover {
            transform: translateX(10px);
            color: #1a73e8;
        }

    /* Main Content and Other Styles */
    .main-content {
        background-color: var(--mud-palette-background);
        min-height: calc(100vh - 112px);
        padding: 20px;
        transition: background-color 0.5s ease;
    }

    .app-bar {
        transition: all 0.3s ease;
    }

    .app-title {
        display: flex;
        align-items: center;
        font-weight: 600;
    }

    .code-icon {
        animation: spin 4s linear infinite;
    }

    .footer {
        height: 50px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
    }

    .footer-text {
        opacity: 0.8;
        transition: opacity 0.3s ease;
    }

    /* Profile Menu */
    .profile-menu {
        margin-right: 20px;
    }
</style>
